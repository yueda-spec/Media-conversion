<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒ‡ã‚£ã‚¢å¤‰æ›ãƒ„ãƒ¼ãƒ« v12.0</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f2f5; padding-top: 1.5rem; padding-bottom: 2rem; font-family: "Helvetica Neue", Arial, sans-serif; }
        .main-container { max-width: 900px; margin: 0 auto; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.12); }
        .nav-pills .nav-link { background-color: #f1f3f5; color: #495057; font-weight: bold; border-radius: 50px; padding: 12px 20px; margin: 0 5px; border: 1px solid #dee2e6; transition: all 0.3s ease; }
        .nav-pills .nav-link:hover { background-color: #e9ecef; transform: translateY(-2px); }
        .nav-pills .nav-link.active { background-color: #0d6efd; color: white; box-shadow: 0 4px 10px rgba(13, 110, 253, 0.4); transform: translateY(0); border-color: #0d6efd; }
        .mode-card { border: 2px solid #e9ecef; padding: 15px; margin-bottom: 12px; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
        .mode-card:hover { background-color: #f8f9fa; border-color: #dee2e6; }
        .mode-card.selected { border-color: #0d6efd; background-color: #f0f7ff; }
        .result-item { background: #fff; border-bottom: 1px solid #eee; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
        .result-item:last-child { border-bottom: none; }
        .status-badge { font-size: 0.85rem; padding: 5px 12px; border-radius: 20px; min-width: 100px; text-align: center; display: inline-block; font-weight: bold;}
        .status-waiting { background: #eee; color: #666; }
        .status-processing { background: #cfe2ff; color: #084298; }
        .status-success { background: #d1e7dd; color: #0f5132; }
        .status-error { background: #f8d7da; color: #842029; }
        .save-area { display: none; padding: 15px; background: #e0e7ff; border-top: 1px solid #c7d2fe; text-align: center; }
        .description-box { background-color: #fff3cd; border: 1px solid #ffecb5; padding: 15px; border-radius: 8px; margin-top: 15px; display: none; color: #664d03; }
        .footer-info { margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid #eee; font-size: 0.85rem; color: #6c757d; }
        .footer-section-title { font-weight: bold; margin-bottom: 0.5rem; color: #343a40; display: flex; align-items: center; }
        .related-links a { color: #6c757d; text-decoration: none; font-weight: bold; transition: color 0.2s; }
        .related-links a:hover { color: #0d6efd; text-decoration: underline; }
        #engine-status { display: none; }
    </style>
</head>
<body>

<div class="main-container">
    <h3 class="mb-4 text-center fw-bold text-dark">ãƒ¡ãƒ‡ã‚£ã‚¢å¤‰æ›ãƒ„ãƒ¼ãƒ« v12.0</h3>
    <div id="engine-status" class="alert alert-danger py-2 text-center small"></div>
    
    <ul class="nav nav-pills nav-fill mb-4" id="myTab" role="tablist">
        <li class="nav-item"><button class="nav-link active" id="photo-tab" data-bs-toggle="tab" data-bs-target="#photo-pane">ğŸ“· HEICç”»åƒ</button></li>
        <li class="nav-item"><button class="nav-link" id="pdf-tab" data-bs-toggle="tab" data-bs-target="#pdf-pane">ğŸ“„ PDFå¤‰æ›</button></li>
        <li class="nav-item"><button class="nav-link" id="video-tab" data-bs-toggle="tab" data-bs-target="#video-pane">ğŸ¥ å‹•ç”»å¤‰æ›</button></li>
    </ul>

    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="photo-pane">
            <div class="mb-3"><input type="file" class="form-control" id="photo-uploader" accept=".heic,.HEIC" multiple></div>
            <button id="photo-convert-btn" class="btn btn-secondary w-100 py-2 fw-bold" disabled>ã‚¨ãƒ³ã‚¸ãƒ³æº–å‚™ä¸­...</button>
            <div class="card mt-4">
                <div class="card-header bg-light fw-bold">å†™çœŸå¤‰æ›ãƒªã‚¹ãƒˆ</div>
                <div id="photo-result-list" class="card-body p-0"></div>
                <div id="photo-save-area" class="save-area">
                    <div class="d-flex justify-content-center gap-3">
                        <button id="photo-single-btn" class="btn btn-success fw-bold px-4" style="display:none;">â¬‡ ä¿å­˜</button>
                        <button id="photo-zip-btn" class="btn btn-secondary fw-bold px-4" disabled>ğŸ“¦ ZIPã§ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="pdf-pane">
            <div class="pdf-settings p-3 bg-light rounded border mb-3">
                <label class="form-label fw-bold mb-2">å‡ºåŠ›å½¢å¼:</label>
                <div class="d-flex gap-4">
                    <div class="form-check"><input class="form-check-input" type="radio" name="pdfFormat" id="pdf-jpg" value="jpeg" checked><label class="form-check-label" for="pdf-jpg">JPEG</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="pdfFormat" id="pdf-png" value="png"><label class="form-check-label" for="pdf-png">PNG</label></div>
                </div>
            </div>
            <div class="mb-3"><input type="file" class="form-control" id="pdf-uploader" accept=".pdf" multiple></div>
            <button id="pdf-convert-btn" class="btn btn-danger w-100 py-2 fw-bold">PDFã‚’ç”»åƒã«å¤‰æ›</button>
            <div class="card mt-4">
                <div class="card-header bg-light fw-bold">PDFå¤‰æ›ãƒªã‚¹ãƒˆ</div>
                <div id="pdf-result-list" class="card-body p-0"></div>
                <div id="pdf-save-area" class="save-area">
                    <div class="d-flex justify-content-center gap-3">
                        <button id="pdf-single-btn" class="btn btn-success fw-bold px-4" style="display:none;">â¬‡ ä¿å­˜</button>
                        <button id="pdf-zip-btn" class="btn btn-secondary fw-bold px-4" disabled>ğŸ“¦ ZIPã§ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="video-pane">
            <div class="alert alert-warning py-3 mb-4 border-warning">
                <div class="d-flex align-items-center mb-1"><span class="fs-5 me-2">âš ï¸</span><h6 class="alert-heading fw-bold mb-0">æœ¬æ©Ÿèƒ½ã¯ã€Œç°¡æ˜“ç‰ˆã€ã§ã™</h6></div>
                <p class="mb-0 ms-1 small">ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å‹•ä½œã™ã‚‹ãŸã‚ã€å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯å¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç‰ˆã‚½ãƒ•ãƒˆ(HandBrakeç­‰)ã®åˆ©ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
            </div>
            <div class="mb-3"><input type="file" class="form-control" id="video-uploader" multiple onchange="scanFiles(this)"></div>
            <label class="form-label fw-bold">2. å¤‰æ›ãƒ¢ãƒ¼ãƒ‰</label>
            <div class="row">
                <div class="col-md-4"><div class="mode-card" onclick="selectMode('rewrap')"><div class="form-check"><input class="form-check-input" type="radio" name="videoMode" id="mode-rewrap" value="rewrap"><label class="form-check-label fw-bold" for="mode-rewrap">ã‚³ãƒ³ãƒ†ãƒŠå¤‰æ›</label></div></div></div>
                <div class="col-md-4"><div class="mode-card" onclick="selectMode('cfr')"><div class="form-check"><input class="form-check-input" type="radio" name="videoMode" id="mode-cfr" value="cfr"><label class="form-check-label fw-bold" for="mode-cfr">VFR â†’ CFR</label></div></div></div>
                <div class="col-md-4"><div class="mode-card" onclick="selectMode('reencode')"><div class="form-check"><input class="form-check-input" type="radio" name="videoMode" id="mode-reencode" value="reencode"><label class="form-check-label fw-bold" for="mode-reencode">MP4å†å¤‰æ›</label></div></div></div>
            </div>
            <div id="desc-rewrap" class="description-box"><strong>âš¡ ã‚³ãƒ³ãƒ†ãƒŠå¤‰æ›:</strong> çˆ†é€Ÿã€‚ç®±ã ã‘å…¥æ›¿ã€‚</div>
            <div id="desc-cfr" class="description-box"><strong>ğŸ”„ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆå›ºå®š:</strong> 29.97fpsï¼‹å¶æ•°è§£åƒåº¦åŒ–ã€‚EDIUSæ•‘æ¸ˆç”¨ã€‚</div>
            <div id="desc-reencode" class="description-box"><strong>ğŸ› ï¸ MP4å†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰:</strong> ç‰¹æ®Šå½¢å¼ã‚’æ±ç”¨MP4åŒ–ã€‚é˜²çŠ¯ã‚«ãƒ¡ãƒ©ãƒ»ç‹¬è‡ªå½¢å¼ã®æ•‘æ¸ˆã«ã€‚</div>
            <button id="video-convert-btn" class="btn btn-primary w-100 mt-4 py-2 fw-bold"><span id="btn-text">å¤‰æ›é–‹å§‹</span></button>
            <div class="card mt-4">
                <div class="card-header bg-light fw-bold">å‹•ç”»å¤‰æ›ãƒªã‚¹ãƒˆ</div>
                <div id="video-result-list" class="card-body p-0"><div class="text-center text-muted p-3">ã“ã“ã«é¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div></div>
                <div id="video-save-area" class="save-area">
                    <div class="d-flex justify-content-center gap-3">
                        <button id="video-single-btn" class="btn btn-success fw-bold px-4" style="display:none;">â¬‡ ä¿å­˜</button>
                        <button id="video-zip-btn" class="btn btn-secondary fw-bold px-4" disabled>ğŸ“¦ ZIPã§ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer-info">
        <div class="row">
            <div class="col-md-6 mb-3">
                <div class="footer-section-title text-success">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shield-lock-fill me-2" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0c-.69 0-1.843.265-2.928.56-1.11.3-2.229.655-2.887.87a1.54 1.54 0 0 0-1.044 1.262c-.596 4.477.787 7.795 2.465 9.99a11.777 11.777 0 0 0 2.517 2.453c.386.273.744.482 1.048.625.28.132.581.24.829.24s.548-.108.829-.24a7.159 7.159 0 0 0 1.048-.625 11.775 11.775 0 0 0 2.517-2.453c1.678-2.195 3.061-5.513 2.465-9.99a1.541 1.541 0 0 0-1.044-1.263 62.467 62.467 0 0 0-2.887-.87C9.843.266 8.69 0 8 0zm0 5a1.5 1.5 0 0 1 .5 2.915l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99A1.5 1.5 0 0 1 8 5z"/></svg>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼
                </div>
                <p class="mb-0">æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã€ã™ã¹ã¦ã®å¤‰æ›å‡¦ç†ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰ã§å®Œçµã—ã¦è¡Œã„ã¾ã™ã€‚</p>
            </div>
            <div class="col-md-6 mb-3">
                <div class="footer-section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-square me-2" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M6.854 4.646a.5.5 0 0 1 0 .708L4.207 8l2.647 2.646a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 0 1 .708 0zm2.292 0a.5.5 0 0 0 0 .708L11.793 8l-2.647 2.646a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708 0z"/></svg>License Info
                </div>
                <ul class="list-unstyled mb-0" style="columns: 2; font-size: 0.8rem;"><li>â€¢ FFmpeg (LGPL/GPL)</li><li>â€¢ Bootstrap (MIT)</li><li>â€¢ JSZip (MIT)</li><li>â€¢ FileSaver.js (MIT)</li><li>â€¢ heic2any (MIT)</li><li>â€¢ heic-to (MIT)</li><li>â€¢ PDF.js (Apache 2.0)</li></ul>
            </div>
        </div>
    </div>
</div>

<div class="text-center mt-4 mb-5 text-muted related-links">
    <small class="fw-bold mb-2 d-block text-uppercase" style="letter-spacing: 1px;">Other Tools</small>
    <div class="d-flex justify-content-center gap-4">
        <a href="telop.html">ğŸï¸ AIãƒ†ãƒ­ãƒƒãƒ—ãƒã‚§ãƒƒã‚«ãƒ¼</a>
        <a href="https://yueda-spec.github.io/V-checker/" target="_blank">ğŸ“º V-checker</a>
        <a href="https://yueda-spec.github.io/ToolKit/" target="_blank">ğŸ§® è¨ˆç®—ãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script type="module">
    import * as pdfjsLib from 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.min.mjs';
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.3.136/pdf.worker.min.mjs';
    window.pdfjsLib = pdfjsLib;
</script>
<script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
<script>
    // æ—¢å­˜ã®HEIC/PDF/å‹•ç”»å¤‰æ›ã®JSã‚³ãƒ¼ãƒ‰ï¼ˆãƒ†ãƒ­ãƒƒãƒ—éƒ¨åˆ†ã¯å‰Šé™¤æ¸ˆã¿ï¼‰
    const libs={heicTo:["https://cdn.jsdelivr.net/npm/heic-to@1.3.0/dist/iife/heic-to.js","https://unpkg.com/heic-to@1.3.0/dist/iife/heic-to.js"],heic2any:["https://cdnjs.cloudflare.com/ajax/libs/heic2any/0.0.4/heic2any.min.js","https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"]};
    function loadScript(e){return new Promise((t,n)=>{const o=document.createElement("script");o.src=e,o.onload=()=>t(!0),o.onerror=()=>n(!1),document.head.appendChild(o)})}
    async function initEngines(){const e=document.getElementById("engine-status"),t=document.getElementById("photo-convert-btn");let n=!1;for(const o of libs.heicTo)try{await loadScript(o);if(typeof HeicTo!="undefined"||typeof window.heicTo!="undefined"){n=!0;break}}catch(e){}let o=!1;for(const t of libs.heic2any)try{await loadScript(t);if(typeof heic2any!="undefined"){o=!0;break}}catch(e){}n||o?(e.style.display="none",t.disabled=!1,t.innerText="å¤‰æ›é–‹å§‹",t.classList.remove("btn-secondary"),t.classList.add("btn-success")):(e.style.display="block",e.innerHTML="<strong>âŒ èª­ã¿è¾¼ã¿å¤±æ•—:</strong> ã‚¨ãƒ³ã‚¸ãƒ³ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸã€‚")}
    initEngines();

    let objectUrls=[],ffmpeg=null;const{createFFmpeg,fetchFile}=FFmpeg;
    function cleanUpObjectUrls(){objectUrls.forEach(e=>URL.revokeObjectURL(e)),objectUrls=[]}
    function addResultRow(e,t,n,o,r,c=[]){const s=document.getElementById(e);(s.querySelector(".text-muted")||""===s.innerHTML)&&(s.innerHTML="");let d="";c.forEach(e=>{d+=`<span class="${"danger"===e.type?"tag-danger":"safe"===e.type?"tag-safe":"tag-warning"}">${e.text}</span>`});const a=document.createElement("div");a.className="result-item",a.id=r,a.innerHTML=`<div class="d-flex align-items-center overflow-hidden"><div class="text-truncate fw-bold" style="max-width: 300px;">${t}</div>${d}</div><div class="d-flex align-items-center"><span class="status-badge ${o} me-3" id="${r}-status">${n}</span></div>`,s.appendChild(a)}
    function updateResultRow(e,t,n){const o=document.getElementById(`${e}-status`);o&&(o.className=`status-badge ${n} me-3`,o.innerText=t)}
    function selectMode(e){document.getElementById("mode-"+e).checked=!0,document.querySelectorAll(".mode-card").forEach(e=>e.classList.remove("selected")),document.getElementById("mode-"+e).closest(".mode-card").classList.add("selected"),document.querySelectorAll(".description-box").forEach(e=>e.style.display="none"),document.getElementById("desc-"+e).style.display="block"}
    function updateDownloadButtons(e,t,n){const o=document.getElementById(t),r=document.getElementById(n);1===e?(o.style.display="inline-block",r.disabled=!0,r.classList.add("btn-secondary"),r.classList.remove("btn-success")):(o.style.display="none",r.disabled=!1,r.classList.remove("btn-secondary"),r.classList.add("btn-success"))}
    const ensureFFmpegLoaded=async()=>{null===ffmpeg?(ffmpeg=createFFmpeg({log:!0}),await ffmpeg.load()):ffmpeg.isLoaded()||await ffmpeg.load()};

    // å‹•ç”»
    async function scanFiles(e){const t=document.getElementById("video-result-list");t.innerHTML="";const n=Array.from(e.files);for(let e=0;e<n.length;e++){const o=n[e],r=[],c=o.name.toUpperCase().split(".").pop(),s=["DAV","H264","264","DAT","VOB"].includes(c);let d=s;if(!d)try{const e=await checkContainerSignature(o);e&&(d=!0)}catch(e){}d&&r.push({text:"âš ï¸ MP4å†å¤‰æ›ãƒ¢ãƒ¼ãƒ‰æ¨å¥¨",type:"warning"}),"MP4"!==c&&"MOV"!==c||checkHevcBinary(o).then(e=>{e&&r.push({text:"âš ï¸ MP4å†å¤‰æ›ãƒ¢ãƒ¼ãƒ‰å¿…é ˆ",type:"danger"})}),addResultRow("video-result-list",o.name,"å¾…æ©Ÿä¸­","status-waiting",`v-row-${e}`,r)}}
    async function checkContainerSignature(e){return new Promise(t=>{const n=new FileReader;n.onload=e=>{const n=Array.from(new Uint8Array(e.target.result)).map(e=>e.toString(16).padStart(2,"0").toUpperCase()).join("");t(n.startsWith("52494646")&&n.includes("41564920")?"AVI":n.startsWith("1A45DFA3")?"MKV":n.startsWith("464C56")?"FLV":n.startsWith("47")?"TS":!!n.startsWith("000001BA")&&"MPG")},n.onerror=()=>t(null),n.readAsArrayBuffer(e.slice(0,32))})}
    async function checkHevcBinary(e){const t=2097152,n=(n,o)=>new Promise(t=>{const r=new FileReader;r.onload=e=>{const n=new Uint8Array(e.target.result),o=[[104,118,99,49],[104,101,118,49],[100,118,104,101],[100,118,104,49]];for(let e=0;e<n.length-4;e++)for(let r of o)if(n[e]===r[0]&&n[e+1]===r[1]&&n[e+2]===r[2]&&n[e+3]===r[3])return void t(!0);t(!1)},r.onerror=()=>t(!1);const c=e.slice(n,o);r.readAsArrayBuffer(c)});let o=await n(0,t);return o||e.size>t&&(o=await n(e.size-t,e.size)),o}
    
    let convertedVideos=[];
    document.getElementById("video-convert-btn").addEventListener("click",async()=>{const e=document.getElementById("video-uploader"),t=document.querySelector('input[name="videoMode"]:checked'),n=document.getElementById("video-convert-btn"),o=document.getElementById("btn-text"),r=document.getElementById("video-save-area");if(0===e.files.length)return void alert("ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„");if(!t)return void alert("ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„");try{n.disabled=!0,await ensureFFmpegLoaded(),o.innerText="å¤‰æ›ä¸­...",r.style.display="none",cleanUpObjectUrls(),convertedVideos=[];const c=Array.from(e.files);for(let e=0;e<c.length;e++){const s=c[e],d=`v-row-${e}`,a=`in_${e}`,l=`out_${e}.mp4`;updateResultRow(d,"æº–å‚™ä¸­...","status-processing");try{ffmpeg.FS("writeFile",a,await fetchFile(s));let e="rewrap"===t.value?["-fflags","+genpts","-i",a,"-c","copy","-map","0","-ignore_unknown",l]:["-i",a,"-map","0:v:0?","-map","0:a:0?","-vf","scale=trunc(iw/2)*2:trunc(ih/2)*2","-r","30000/1001","-pix_fmt","yuv420p","-c:v","libx264","-preset","superfast","-c:a","aac","-ar","48000",l];await ffmpeg.run(...e);const i=ffmpeg.FS("readFile",l),u=new Blob([i.buffer],{type:"video/mp4"});convertedVideos.push({name:`converted_${s.name.replace(/\.[^/.]+$/,"")}.mp4`,blob:u}),updateResultRow(d,"å®Œäº†","status-success");try{ffmpeg.FS("unlink",a),ffmpeg.FS("unlink",l)}catch(e){}}catch(e){console.error(e),updateResultRow(d,"ã‚¨ãƒ©ãƒ¼","status-error")}}o.innerText="å¤‰æ›é–‹å§‹",n.disabled=!1,updateDownloadButtons(convertedVideos.length,"video-single-btn","video-zip-btn"),convertedVideos.length>0&&(r.style.display="block")}catch(e){console.error(e),alert("ã‚¨ãƒ©ãƒ¼"),n.disabled=!1}});
    document.getElementById("video-single-btn").onclick=function(){if(convertedVideos.length>0){const e=convertedVideos[0],t=URL.createObjectURL(e.blob);objectUrls.push(t),saveAs(e.blob,e.name)}};
    document.getElementById("video-zip-btn").onclick=function(){const e=new JSZip;convertedVideos.forEach(t=>e.file(t.name,t.blob)),e.generateAsync({type:"blob"}).then(e=>saveAs(e,"video_converted.zip"))};

    // å†™çœŸ/PDF (åœ§ç¸®ç‰ˆã‚³ãƒ¼ãƒ‰)
    let convertedPhotos=[];document.getElementById("photo-convert-btn").addEventListener("click",async()=>{const e=document.getElementById("photo-uploader"),t=document.getElementById("photo-convert-btn"),n=document.getElementById("photo-save-area"),o="undefined"!=typeof HeicTo||"undefined"!=typeof window.heicTo,r="undefined"!=typeof heic2any;if(!o&&!r)return void alert("ã‚¨ãƒ³ã‚¸ãƒ³æœªãƒ­ãƒ¼ãƒ‰");if(0===e.files.length)return void alert("é¸æŠã—ã¦ãã ã•ã„");t.disabled=!0,n.style.display="none",document.getElementById("photo-result-list").innerHTML="",convertedPhotos=[];const c=Array.from(e.files);c.forEach((e,t)=>addResultRow("photo-result-list",e.name,"å¾…æ©Ÿä¸­","status-waiting",`p-row-${t}`));for(let e=0;e<c.length;e++){const n=`p-row-${e}`,s=c[e];let d=!1;if(o)try{updateResultRow(n,"å¤‰æ›ä¸­...","status-processing");const e=window.HeicTo||window.heicTo,t=await e({blob:s,type:"image/jpeg",quality:.9});convertedPhotos.push({name:s.name.replace(/\.[^/.]+$/,"")+".jpg",blob:t}),updateResultRow(n,"å®Œäº†","status-success"),d=!0}catch(e){}if(!d&&r)try{const e=await heic2any({blob:s,toType:"image/jpeg",quality:.9}),t=Array.isArray(e)?e[0]:e;convertedPhotos.push({name:s.name.replace(/\.[^/.]+$/,"")+".jpg",blob:t}),updateResultRow(n,"å®Œäº†","status-success"),d=!0}catch(e){}d||updateResultRow(n,"å¤‰æ›å¤±æ•—","status-error")}t.disabled=!1,updateDownloadButtons(convertedPhotos.length,"photo-single-btn","photo-zip-btn"),convertedPhotos.length>0&&(n.style.display="block")});document.getElementById("photo-single-btn").onclick=function(){convertedPhotos.length>0&&saveAs(convertedPhotos[0].blob,convertedPhotos[0].name)},document.getElementById("photo-zip-btn").onclick=function(){const e=new JSZip;convertedPhotos.forEach(t=>e.file(t.name,t.blob)),e.generateAsync({type:"blob"}).then(e=>saveAs(e,"photo_converted.zip"))};let convertedPdfs=[];document.getElementById("pdf-convert-btn").addEventListener("click",async()=>{const e=document.getElementById("pdf-uploader"),t=document.querySelector('input[name="pdfFormat"]:checked').value,n=document.getElementById("pdf-convert-btn"),o=document.getElementById("pdf-save-area");if(0===e.files.length)return void alert("PDFã‚’é¸æŠã—ã¦ãã ã•ã„");n.disabled=!0,o.style.display="none",document.getElementById("pdf-result-list").innerHTML="",convertedPdfs=[];const r=Array.from(e.files);for(let e=0;e<r.length;e++){const n=r[e];try{const o=await n.arrayBuffer(),r=await pdfjsLib.getDocument(o).promise;for(let e=1;e<=r.numPages;e++){const o=`pdf-${n.name}-p${e}`;addResultRow("pdf-result-list",`${n.name} (P.${e})`,"å¤‰æ›ä¸­","status-processing",o);const c=await r.getPage(e),s=c.getViewport({scale:2}),d=document.createElement("canvas"),a=d.getContext("2d");d.height=s.height,d.width=s.width,await c.render({canvasContext:a,viewport:s}).promise,await new Promise(r=>d.toBlob(c=>{convertedPdfs.push({name:n.name.replace(/\.pdf$/i,"")+`_page${String(e).padStart(2,"0")}.${"png"===t?"png":"jpg"}`,blob:c}),updateResultRow(o,"å®Œäº†","status-success"),r()},"png"===t?"image/png":"image/jpeg",.9))}}catch(e){console.error(e)}}n.disabled=!1,updateDownloadButtons(convertedPdfs.length,"pdf-single-btn","pdf-zip-btn"),o.style.display="block"});document.getElementById("pdf-single-btn").onclick=function(){convertedPdfs.length>0&&saveAs(convertedPdfs[0].blob,convertedPdfs[0].name)},document.getElementById("pdf-zip-btn").onclick=function(){const e=new JSZip;convertedPdfs.forEach(t=>e.file(t.name,t.blob)),e.generateAsync({type:"blob"}).then(e=>saveAs(e,"pdf_converted.zip"))};
</script>
</body>
</html>
